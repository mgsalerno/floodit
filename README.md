# Flood-It Solver

### C program that receives a Flood-It game instance and outputs a color sequence that paints the whole board with a single color.

#### Status: Finished

[About](#about) | [Installation](#installation) | [Usage](#usage) | [Technologies](#technologies) | [License](#license)

## About

The program receives a game instance from stdin.

An instance is given by a text file in the following format:

- the first line of the file has **3** integers **n, m and k**, separated by spaces, where **n** is the number of rows on the board, **m** is the number of columns in the board and **k** is the number of colors on the board;

- the rest of the file contains **n** lines with **m** integers each, separated by spaces, each of which belongs to the range **[1..k]**;

- the example below is a game instance with 4 rows, 5 columns and 3 colors:

      4 5 3
      2 3 2 3 2
      2 1 2 3 3
      3 1 2 3 2
      1 2 2 1 3

The output has two lines:

- the first line is an integer that indicates the size of the sequence of numbers in the second line;

- the second line is a sequence of integers belonging to the range **[1..k]**, separated by a space and terminated by a line break.

This sequence represents the colors that should be used to paint the board with a single color. The paint operation changes the color of the region that contains the cell in the upper left corner of the table.

For example, consider the following color sequence, for the board given as an example:

      5
      3 2 1 3 2

When applying the paint operation, using this color sequence, the following transformations take place on the board:

Paint with color 3:

      3 3 2 3 2
      3 1 2 3 3
      3 1 2 3 2
      1 2 2 1 3

Paint with color 2:

      2 2 2 3 2
      2 1 2 3 3
      2 1 2 3 2
      1 2 2 1 3

Paint with color 1:

      1 1 1 3 2
      1 1 1 3 3
      1 1 1 3 2
      1 1 1 1 3

Paint with color 3:

      3 3 3 3 2
      3 3 3 3 3
      3 3 3 3 2
      3 3 3 3 3

Paint with color 2:

      2 2 2 2 2
      2 2 2 2 2
      2 2 2 2 2
      2 2 2 2 2

Note that at the end the board has **a single color**. Therefore, this sequence solves the instance given as an example.

### Support files

- **map_example_30_30_10**: problem instance example;

- **solution_example_30_30_10**: example of a possible solution for the example instance;

- **generatemap**: program to generate random instances of the problem;

- **verify**: program to check if a given map is solved by a given sequence of colors, returning **0** if yes and **1** otherwise.

- **animate**: program to generate an animation of the solution of a map in the terminal.

- **test.sh**: script to test a map instance randomly generated. The generated map is saved.

- **find.sh**: script that runs infinite random tests until it finds a map instance that the implementation fails to solve. The map that fails the test is saved.

- **floodit_h1**: example solver that uses a greedy algorithm that chooses the color that appears most in the edge of the upper left corner region.

- **floodit_h2**: example solver that uses a greedy algorithm that chooses the color that appears most in the regions adjacent to the upper left corner region.

- **floodit_h4**: example solver that uses a distance-based strategy.

## Installation

### Dependencies

Usually it is not necessary to install anything, but if it shows some error or it can't find some of the C libraries you can try to install the following package:

```bash
sudo apt update
sudo apt install build-essential
```

### Submodules

This proect uses git submodules. So after you cloned the repository, run the following command to update the submodules:

```bash
git submodule update --init
```

## Usage

### Floodit Solver

In the `src` folder, use the `makefile` to compile everything:
```bash
make
```

Run the `floodit` program using the example instance:
```bash
./floodit < ../extra/map_example_30_30_10
```

To clean up the files generated by the `makefile`, just run:
```bash
make clean
```

To purge the files generated by the `makefile`, execute:
```bash
make purge
```

### generatemap

To generate a random instance of the problem, use:

```bash
./generatemap <size> <size> <colors> [<random_seed>]
```

- `<size>`: size of the map.
- `<colors>`: number of distinct colors to apply on this instance.
- `<random_seed>`: random seed to generate the map (optional).

Usage example:

```bash
./generatemap 30 30 10
```

This will generate an instance with the same parameters as the example available.

### verify

Verify if the generated solution to a given map by running:

```bash
  cat map solution | ./verify
```

Usage example:

```bash
  cat map_example_30_30_10 solution_example_30_30_10 | ./verify
```

To get the result in bash:

```bash
  if [ "$?" -eq 0 ]
    then
      echo ok
    else
      echo fail
  fi
```

### animate

Animate the solution for a given map using:

```bash
  cat map solution | ./animate
```

Usage example:

```bash
  cat map_example_30_30_10 solution_example_30_30_10 | ./animate
```

### test.sh

To generate a map instance and run the generated map automatically, use:

```bash
./test.sh <size> <size> <colors> [<random_seed>]
```

- `<size>`: size of the map.
- `<colors>`: number of distinct colors to apply on this instance.
- `<random_seed>`: random seed to generate the map (optional).

Usage example:

```bash
./test.sh 30 30 10
```

### find.sh

Using the following command you can loop through map instances until you find an instance that fails to be solved.

```bash
./find.sh <size> <size> <colors> [<random_seed>]
```
- `<size>`: size of the map.
- `<colors>`: number of distinct colors to apply on this instance.
- `<random_seed>`: random seed to generate the map (optional).

Usage example:

```bash
./find.sh 30 30 10
```

This will run 30x30 map instances with 10 colors until it finds an instance that fails to be solved. **If the script doesn't find a map that fails to be solved, it will keep running forever and you will need to stop it after a while.**

### floodit_h[1|2|4]

The example solvers can be used the same way as the implemented Floodit Solver:

Example usage with the `floodit_h1` program using the example instance in the `extra` folder:
```bash
./floodit_h1 < map_example_30_30_10
```

## Technologies

- C language

## License

This project is licensed under the GNU General Public License v3.0 - see the [LICENSE](LICENSE) file for details.

